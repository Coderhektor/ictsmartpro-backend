<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üöÄ Advanced Trading Bot v5.1 - Real-Time Market Analysis</title>
<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Inter Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<!-- TradingView Widget -->
<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<style>
:root {
--bg-primary: #0a0f1a;
--bg-secondary: #141a27;
--bg-card: #1a2133;
--accent-blue: #3b82f6;
--accent-blue-light: #60a5fa;
--accent-green: #10b981;
--accent-green-light: #34d399;
--accent-red: #ef4444;
--accent-red-light: #f87171;
--accent-purple: #8b5cf6;
--accent-purple-light: #a78bfa;
--accent-yellow: #f59e0b;
--accent-orange: #f97316;
--accent-cyan: #06b6d4;
--accent-pink: #ec4899;
--text-primary: #ffffff;
--text-secondary: #9ca3af;
--text-muted: #6b7280;
--border-color: rgba(255, 255, 255, 0.1);
--border-radius: 16px;
--shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
--shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
--shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.4);
--transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
--neon-blue: 0 0 20px rgba(59, 130, 246, 0.5);
--neon-green: 0 0 20px rgba(16, 185, 129, 0.5);
--neon-red: 0 0 20px rgba(239, 68, 68, 0.5);
--neon-purple: 0 0 20px rgba(139, 92, 246, 0.5);
--neon-cyan: 0 0 20px rgba(6, 182, 212, 0.5);
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
background: linear-gradient(135deg, #0a0f1a 0%, #0f1423 50%, #141a27 100%);
color: var(--text-primary);
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
min-height: 100vh;
overflow-x: hidden;
line-height: 1.6;
}

/* Animated Neon Background */
body::before {
content: '';
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: 
radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
radial-gradient(circle at 80% 70%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
radial-gradient(circle at 50% 50%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
pointer-events: none;
z-index: 0;
animation: bgPulse 8s ease-in-out infinite;
}

@keyframes bgPulse {
0%, 100% { opacity: 0.8; }
50% { opacity: 1; }
}

.container-fluid {
position: relative;
z-index: 1;
max-width: 1800px;
margin: 0 auto;
padding: 0 1.5rem;
}

/* Navbar */
.navbar {
background: rgba(26, 33, 51, 0.95);
backdrop-filter: blur(20px);
border-bottom: 2px solid var(--accent-blue);
padding: 1rem 0;
box-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
position: sticky;
top: 0;
z-index: 1000;
}

.navbar-brand {
font-weight: 800;
font-size: 1.5rem;
letter-spacing: -0.5px;
background: linear-gradient(135deg, #ffffff, var(--accent-blue-light), var(--accent-purple-light));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
}

.navbar-brand i {
color: var(--accent-blue);
margin-right: 8px;
text-shadow: 0 0 15px var(--accent-blue);
}

.status-badge {
background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
padding: 8px 24px;
border-radius: 30px;
font-size: 0.9rem;
font-weight: 700;
box-shadow: var(--neon-green);
animation: pulse 2s ease-in-out infinite;
display: inline-flex;
align-items: center;
gap: 8px;
border: 1px solid rgba(255, 255, 255, 0.2);
}

@keyframes pulse {
0%, 100% { box-shadow: 0 0 25px rgba(16, 185, 129, 0.5); }
50% { box-shadow: 0 0 40px rgba(16, 185, 129, 0.8); }
}

/* Cards */
.card {
background: rgba(26, 33, 51, 0.9);
backdrop-filter: blur(10px);
border: 1px solid var(--border-color);
border-radius: var(--border-radius);
box-shadow: var(--shadow-lg);
transition: var(--transition);
overflow: hidden;
position: relative;
}

.card::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 2px;
background: linear-gradient(90deg, transparent, var(--accent-blue), var(--accent-purple), var(--accent-cyan), transparent);
animation: borderFlow 4s linear infinite;
}

@keyframes borderFlow {
0% { left: -100%; }
100% { left: 100%; }
}

.card:hover {
transform: translateY(-6px);
box-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
border-color: rgba(59, 130, 246, 0.4);
}

.card-header {
background: rgba(0, 0, 0, 0.2);
border-bottom: 1px solid rgba(59, 130, 246, 0.3);
padding: 1rem 1.5rem;
font-weight: 700;
font-size: 1.1rem;
color: var(--accent-blue-light);
text-shadow: 0 0 10px rgba(59, 130, 246, 0.2);
}

.card-body {
padding: 1.5rem;
}

.card-title {
font-weight: 800;
font-size: 1.2rem;
letter-spacing: -0.3px;
margin-bottom: 1rem;
color: var(--text-primary);
display: flex;
align-items: center;
gap: 10px;
}

.card-title i {
color: var(--accent-blue);
font-size: 1.3rem;
text-shadow: 0 0 15px var(--accent-blue);
}

/* Price Display */
.price-container {
text-align: center;
padding: 2rem 1.5rem;
}

.symbol-name {
font-size: 1.5rem;
font-weight: 800;
color: var(--accent-blue-light);
margin-bottom: 1rem;
letter-spacing: -0.5px;
text-shadow: 0 0 15px var(--accent-blue);
}

.current-price {
font-size: 3.8rem;
font-weight: 900;
letter-spacing: -2px;
background: linear-gradient(135deg, #ffffff, var(--accent-blue-light), var(--accent-cyan));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
line-height: 1.1;
margin: 1rem 0;
text-shadow: 0 0 30px rgba(59, 130, 246, 0.4);
animation: priceGlow 2s ease-in-out infinite;
}

@keyframes priceGlow {
0%, 100% { text-shadow: 0 0 30px rgba(59, 130, 246, 0.4); }
50% { text-shadow: 0 0 50px rgba(59, 130, 246, 0.7); }
}

.price-change {
font-size: 1.3rem;
font-weight: 700;
margin-top: 1rem;
display: inline-flex;
align-items: center;
gap: 8px;
}

.price-up {
color: var(--accent-green);
background: rgba(16, 185, 129, 0.15);
padding: 8px 20px;
border-radius: 20px;
box-shadow: var(--neon-green);
border: 1px solid rgba(16, 185, 129, 0.5);
}

.price-down {
color: var(--accent-red);
background: rgba(239, 68, 68, 0.15);
padding: 8px 20px;
border-radius: 20px;
box-shadow: var(--neon-red);
border: 1px solid rgba(239, 68, 68, 0.5);
}

/* Signal Cards */
.signal-badge {
padding: 2.5rem 2rem;
border-radius: var(--border-radius);
font-size: 2.2rem;
font-weight: 900;
letter-spacing: -0.5px;
margin-bottom: 1.5rem;
position: relative;
overflow: hidden;
box-shadow: var(--shadow-lg);
border: 1px solid rgba(255, 255, 255, 0.2);
background-clip: padding-box;
}

.signal-text {
position: relative;
z-index: 2;
text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
}

.signal-buy {
background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
color: white;
box-shadow: 0 0 30px rgba(16, 185, 129, 0.6);
}

.signal-sell {
background: linear-gradient(135deg, var(--accent-red), var(--accent-orange));
color: white;
box-shadow: 0 0 30px rgba(239, 68, 68, 0.6);
}

.signal-neutral {
background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
color: white;
box-shadow: 0 0 30px rgba(139, 92, 246, 0.6);
}

/* Signal Histogram */
.signal-histogram {
background: rgba(20, 26, 39, 0.8);
border-radius: 16px;
padding: 1.5rem;
margin-top: 1.5rem;
border: 1px solid var(--border-color);
}

.histogram-title {
font-weight: 700;
font-size: 1.1rem;
margin-bottom: 1.2rem;
color: var(--accent-blue-light);
display: flex;
align-items: center;
gap: 8px;
text-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
}

.histogram-bar {
height: 100%;
border-radius: 12px;
transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
position: relative;
overflow: hidden;
box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
}

.histogram-bar-buy {
background: linear-gradient(90deg, var(--accent-green), var(--accent-cyan));
box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
}

.histogram-bar-sell {
background: linear-gradient(90deg, var(--accent-red), var(--accent-orange));
box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);
}

.histogram-bar-neutral {
background: linear-gradient(90deg, var(--accent-purple), var(--accent-pink));
box-shadow: 0 0 15px rgba(139, 92, 246, 0.4);
}

.histogram-value.buy {
color: var(--accent-green);
text-shadow: 0 0 10px var(--accent-green);
}

.histogram-value.sell {
color: var(--accent-red);
text-shadow: 0 0 10px var(--accent-red);
}

.histogram-value.neutral {
color: var(--accent-purple);
text-shadow: 0 0 10px var(--accent-purple);
}

/* Confidence Bar */
.confidence-bar {
height: 14px;
background: rgba(255, 255, 255, 0.08);
border-radius: 12px;
overflow: hidden;
margin: 1.2rem 0;
border: 1px solid var(--border-color);
}

.confidence-fill {
height: 100%;
background: linear-gradient(90deg, var(--accent-red), var(--accent-yellow), var(--accent-green), var(--accent-cyan));
border-radius: 12px;
transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
position: relative;
overflow: hidden;
}

.confidence-high {
color: var(--accent-green);
text-shadow: 0 0 15px var(--accent-green);
}

.confidence-medium {
color: var(--accent-yellow);
text-shadow: 0 0 15px var(--accent-yellow);
}

.confidence-low {
color: var(--accent-red);
text-shadow: 0 0 15px var(--accent-red);
}

/* Indicator Cards */
.indicator-detail-card {
background: rgba(20, 26, 39, 0.9);
backdrop-filter: blur(5px);
border-radius: 12px;
padding: 1rem;
margin-bottom: 1rem;
border-left: 4px solid var(--accent-blue);
transition: var(--transition);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.indicator-detail-card:hover {
transform: translateX(5px);
box-shadow: 0 0 25px rgba(59, 130, 246, 0.2);
}

.indicator-detail-card.buy {
border-left-color: var(--accent-green);
}

.indicator-detail-card.sell {
border-left-color: var(--accent-red);
}

.indicator-signal-buy {
background: rgba(16, 185, 129, 0.2);
color: var(--accent-green-light);
border: 1px solid var(--accent-green);
box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
}

.indicator-signal-sell {
background: rgba(239, 68, 68, 0.2);
color: var(--accent-red-light);
border: 1px solid var(--accent-red);
box-shadow: 0 0 15px rgba(239, 68, 68, 0.2);
}

.indicator-signal-neutral {
background: rgba(139, 92, 246, 0.2);
color: var(--accent-purple-light);
border: 1px solid var(--accent-purple);
box-shadow: 0 0 15px rgba(139, 92, 246, 0.2);
}

.indicator-value.green {
background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
text-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
}

.indicator-value.red {
background: linear-gradient(135deg, var(--accent-red), var(--accent-orange));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
text-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
}

/* Pattern Tags */
.pattern-tag {
display: inline-block;
padding: 10px 18px;
margin: 6px 4px;
border-radius: 24px;
font-size: 0.9rem;
font-weight: 700;
transition: var(--transition);
border: 1px solid transparent;
}

.pattern-bullish {
background: rgba(16, 185, 129, 0.15);
color: var(--accent-green-light);
border-color: var(--accent-green);
box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
}

.pattern-bearish {
background: rgba(239, 68, 68, 0.15);
color: var(--accent-red-light);
border-color: var(--accent-red);
box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
}

.pattern-neutral {
background: rgba(139, 92, 246, 0.15);
color: var(--accent-purple-light);
border-color: var(--accent-purple);
box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
}

/* Chart Container - SABƒ∞T 800px */
.chart-container {
background: var(--bg-secondary);
border-radius: 16px;
padding: 1.5rem;
height: 800px !important;
min-height: 800px !important;
max-height: 800px !important;
border: 1px solid var(--border-color);
position: relative;
overflow: hidden;
display: flex;
flex-direction: column;
box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
}

#tradingview-widget {
width: 100%;
height: 100% !important;
min-height: 750px;
flex: 1;
}

/* Chat Container */
.chat-container {
height: 400px;
overflow-y: auto;
background: rgba(20, 26, 39, 0.95);
backdrop-filter: blur(10px);
border-radius: 16px;
padding: 1.5rem;
border: 1px solid var(--border-color);
position: relative;
box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
}

.chat-container::-webkit-scrollbar {
width: 8px;
}

.chat-container::-webkit-scrollbar-track {
background: rgba(255, 255, 255, 0.05);
border-radius: 10px;
}

.chat-container::-webkit-scrollbar-thumb {
background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
border-radius: 10px;
box-shadow: 0 0 15px var(--accent-blue);
}

.chat-message {
margin-bottom: 1.2rem;
padding: 1.2rem;
border-radius: 16px;
animation: slideIn 0.4s ease;
position: relative;
max-width: 90%;
border: 1px solid rgba(255, 255, 255, 0.1);
}

.chat-bot {
background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
border-left: 4px solid var(--accent-blue);
box-shadow: 0 0 25px rgba(59, 130, 246, 0.1);
}

@keyframes slideIn {
from { opacity: 0; transform: translateY(15px); }
to { opacity: 1; transform: translateY(0); }
}

/* Buttons */
.btn {
font-weight: 700;
border-radius: 30px;
padding: 0.75rem 1.8rem;
transition: var(--transition);
display: inline-flex;
align-items: center;
justify-content: center;
gap: 8px;
position: relative;
overflow: hidden;
border: none;
}

.btn-primary {
background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
color: white;
box-shadow: 0 0 25px rgba(59, 130, 246, 0.4);
}

.btn-primary:hover {
background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
transform: translateY(-2px);
box-shadow: 0 0 35px rgba(59, 130, 246, 0.6);
}

/* AI Evaluate Button - √ñzel Neon Buton */
.btn-evaluate {
background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink), var(--accent-cyan));
background-size: 200% 200%;
color: white;
font-weight: 800;
padding: 1rem 2rem;
border-radius: 40px;
box-shadow: 0 0 35px rgba(139, 92, 246, 0.5);
animation: gradientShift 3s ease infinite;
border: 1px solid rgba(255, 255, 255, 0.3);
text-transform: uppercase;
letter-spacing: 1px;
}

@keyframes gradientShift {
0% { background-position: 0% 50%; }
50% { background-position: 100% 50%; }
100% { background-position: 0% 50%; }
}

.btn-evaluate:hover {
transform: translateY(-3px);
box-shadow: 0 0 50px rgba(139, 92, 246, 0.8);
}

.btn-outline-success {
border: 1px solid var(--accent-green);
color: var(--accent-green);
background: transparent;
}

.btn-outline-success:hover {
background: var(--accent-green);
color: white;
box-shadow: 0 0 25px rgba(16, 185, 129, 0.5);
}

/* Form Controls */
.form-select {
background: rgba(26, 33, 51, 0.9);
border: 1px solid var(--border-color);
color: var(--text-primary);
border-radius: 30px;
font-weight: 600;
padding: 0.75rem 1.25rem;
transition: var(--transition);
font-family: 'Inter', sans-serif;
font-size: 0.95rem;
backdrop-filter: blur(5px);
}

.form-select:focus {
background: rgba(26, 33, 51, 0.95);
border-color: var(--accent-blue);
box-shadow: 0 0 25px rgba(59, 130, 246, 0.3);
color: var(--text-primary);
}

/* Exchange Cards */
.exchange-card {
background: rgba(20, 26, 39, 0.8);
backdrop-filter: blur(5px);
border-radius: 16px;
padding: 1rem;
text-align: center;
border: 1px solid var(--border-color);
transition: var(--transition);
}

.exchange-card:hover {
transform: translateY(-3px);
border-color: var(--accent-blue);
box-shadow: 0 0 25px rgba(59, 130, 246, 0.2);
background: rgba(59, 130, 246, 0.1);
}

.exchange-logo {
font-size: 2rem;
margin-bottom: 0.5rem;
text-shadow: 0 0 15px currentColor;
}

.status-active {
background: rgba(16, 185, 129, 0.2);
color: var(--accent-green);
border: 1px solid var(--accent-green);
box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
}

/* Spinner */
.spinner {
display: inline-block;
width: 40px;
height: 40px;
border: 4px solid rgba(255, 255, 255, 0.1);
border-top: 4px solid var(--accent-blue);
border-right: 4px solid var(--accent-purple);
border-radius: 50%;
animation: spin 1s linear infinite;
box-shadow: 0 0 25px rgba(59, 130, 246, 0.3);
}

@keyframes spin {
to { transform: rotate(360deg); }
}

/* Badges */
.futures-badge {
background: linear-gradient(135deg, var(--accent-orange), var(--accent-yellow));
padding: 6px 20px;
border-radius: 30px;
font-size: 0.8rem;
font-weight: 700;
box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
display: inline-block;
margin-top: 8px;
border: 1px solid rgba(255, 255, 255, 0.2);
}

.ai-assistant-badge {
background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
padding: 6px 20px;
border-radius: 30px;
font-size: 0.8rem;
font-weight: 700;
box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
display: inline-block;
margin-top: 8px;
letter-spacing: 0.5px;
border: 1px solid rgba(255, 255, 255, 0.2);
}

.real-time-badge {
background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
padding: 4px 16px;
border-radius: 30px;
font-size: 0.75rem;
font-weight: 700;
box-shadow: 0 0 20px rgba(6, 182, 212, 0.4);
display: inline-block;
margin-left: 8px;
animation: pulse 2s ease-in-out infinite;
border: 1px solid rgba(255, 255, 255, 0.2);
}

.connection-status {
display: inline-flex;
align-items: center;
gap: 6px;
padding: 6px 18px;
border-radius: 30px;
font-size: 0.85rem;
font-weight: 600;
margin-left: 12px;
}

.status-connected {
background: rgba(16, 185, 129, 0.2);
color: var(--accent-green-light);
border: 1px solid var(--accent-green);
box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
}

/* ML Models */
.model-fill {
height: 100%;
border-radius: 12px;
transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
position: relative;
overflow: hidden;
}

.model-lgbm {
background: linear-gradient(90deg, var(--accent-green), var(--accent-cyan));
box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
}

.model-lstm {
background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
}

.model-transformer {
background: linear-gradient(90deg, var(--accent-purple), var(--accent-pink));
box-shadow: 0 0 15px rgba(139, 92, 246, 0.4);
}

/* Responsive */
@media (max-width: 1200px) {
.container-fluid { padding: 0 1rem; }
.current-price { font-size: 3.2rem; }
}

@media (max-width: 992px) {
.current-price { font-size: 2.8rem; }
.signal-badge { font-size: 1.8rem; padding: 2rem 1.5rem; }
.chart-container { height: 700px !important; min-height: 700px !important; }
}

@media (max-width: 768px) {
.current-price { font-size: 2.2rem; }
.signal-badge { font-size: 1.6rem; padding: 1.8rem 1.2rem; }
.chart-container { height: 600px !important; min-height: 600px !important; }
}

@media (max-width: 576px) {
.current-price { font-size: 1.8rem; }
.signal-badge { font-size: 1.4rem; padding: 1.5rem 1rem; }
.chart-container { height: 500px !important; min-height: 500px !important; }
}
</style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar">
<div class="container-fluid">
<a class="navbar-brand">
<i class="fas fa-robot"></i>
Advanced Trading Bot v5.1
<span class="connection-status status-connected">
<i class="fas fa-plug"></i>
Connected to 11+ Exchanges
</span>
</a>
<div class="d-flex align-items-center gap-3">
<span class="status-badge">
<i class="fas fa-circle"></i>
LIVE TRADING
</span>
<button class="btn btn-primary btn-sm" onclick="analyzeCurrentSymbol()">
<i class="fas fa-sync-alt"></i>
Refresh Data
</button>
</div>
</div>
</nav>

<div class="container-fluid mt-4 px-3">
<div class="row g-4">
<!-- Left Column -->
<div class="col-lg-8">
<!-- Controls -->
<div class="card mb-4">
<div class="card-header">
<i class="fas fa-sliders-h"></i>
Analysis Controls
</div>
<div class="card-body">
<div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
<h5 class="card-title mb-0">
<i class="fas fa-chart-line"></i>
Real-Time Market Analysis
<span class="real-time-badge">
<i class="fas fa-bolt"></i>
Real-Time
</span>
</h5>
<div class="d-flex gap-3 flex-wrap">
<select id="symbolSelect" class="form-select form-select-sm" style="width: 160px;">
<option value="BTCUSDT">BTC/USDT</option>
<option value="ETHUSDT">ETH/USDT</option>
<option value="XRPUSDT" selected>XRP/USDT</option>
<option value="SOLUSDT">SOL/USDT</option>
<option value="BNBUSDT">BNB/USDT</option>
<option value="ADAUSDT">ADA/USDT</option>
<option value="DOGEUSDT">DOGE/USDT</option>
<option value="MATICUSDT">MATIC/USDT</option>
<option value="LINKUSDT">LINK/USDT</option>
<option value="AVAXUSDT">AVAX/USDT</option>
</select>
<select id="intervalSelect" class="form-select form-select-sm" style="width: 130px;">
<option value="1m">1 Minute</option>
<option value="5m">5 Minutes</option>
<option value="15m">15 Minutes</option>
<option value="30m">30 Minutes</option>
<option value="1h" selected>1 Hour</option>
<option value="4h">4 Hours</option>
<option value="1d">1 Day</option>
<option value="1w">1 Week</option>
</select>
<button class="btn btn-primary" onclick="analyzeCurrentSymbol()">
<i class="fas fa-search"></i>
Analyze
</button>
</div>
</div>
</div>
</div>

<!-- Price & Signal -->
<div class="row g-4 mb-4">
<div class="col-md-6">
<div class="card h-100">
<div class="card-header">
<i class="fas fa-dollar-sign"></i>
Current Price
<span class="data-source-badge">
Live Data
</span>
</div>
<div class="card-body price-container">
<div class="symbol-name" id="currentSymbol">XRP/USDT</div>
<div class="futures-badge">
<i class="fas fa-chart-area"></i>
Futures Trading
</div>
<div class="current-price" id="currentPrice">
<span class="spinner"></span>
</div>
<div class="price-change" id="priceChange">
Loading market data...
</div>
<div class="volume-info mt-3">
<div class="volume-label text-muted">24h Volume</div>
<div class="volume-value" id="volume24h" style="font-size: 1.5rem; color: var(--accent-cyan); text-shadow: 0 0 15px var(--accent-cyan);">-</div>
</div>
</div>
</div>
</div>

<div class="col-md-6">
<div class="card h-100">
<div class="card-header">
<i class="fas fa-brain"></i>
AI Signal
<span class="ai-assistant-badge">
ML-Powered
</span>
</div>
<div class="card-body signal-container">
<div class="signal-badge signal-neutral" id="signalBadge">
<span class="signal-text" id="signalText">ANALYZING</span>
</div>
<div class="confidence-bar">
<div class="confidence-fill" id="confidenceFill" style="width: 0%"></div>
</div>
<div class="confidence-text" id="confidenceText">Confidence: 0%</div>
<p class="text-secondary small mt-3 mb-0" id="signalRecommendation">
Connecting to exchanges...
</p>
</div>
</div>
</div>
</div>

<!-- Signal Histogram -->
<div class="card mb-4">
<div class="card-header">
<i class="fas fa-chart-bar"></i>
Signal Distribution - Detailed Analysis
</div>
<div class="card-body">
<div class="signal-histogram">
<div class="histogram-title">
<i class="fas fa-brain"></i>
ML Model Predictions (Last 100 Signals)
</div>
<div class="histogram-row">
<div class="histogram-label">Buy Signals</div>
<div class="histogram-bar-container">
<div class="histogram-bar histogram-bar-buy" id="buySignalBar" style="width: 0%"></div>
</div>
<div class="histogram-value buy" id="buySignalValue">0%</div>
</div>
<div class="histogram-row">
<div class="histogram-label">Sell Signals</div>
<div class="histogram-bar-container">
<div class="histogram-bar histogram-bar-sell" id="sellSignalBar" style="width: 0%"></div>
</div>
<div class="histogram-value sell" id="sellSignalValue">0%</div>
</div>
<div class="histogram-row">
<div class="histogram-label">Neutral/Hold</div>
<div class="histogram-bar-container">
<div class="histogram-bar histogram-bar-neutral" id="neutralSignalBar" style="width: 0%"></div>
</div>
<div class="histogram-value neutral" id="neutralSignalValue">0%</div>
</div>
</div>
</div>
</div>

<!-- Chart - SABƒ∞T 800px Y√úKSEKLƒ∞K -->
<div class="card mb-4">
<div class="card-header">
<i class="fas fa-chart-candlestick"></i>
Live Price Chart - TradingView
<span class="data-source-badge">
Binance, Bybit, OKEx + 8 More
</span>
</div>
<div class="card-body p-0">
<div class="chart-container" style="border-radius: 0 0 16px 16px;">
<div id="tradingview-widget">
<div class="text-center py-5">
<div class="spinner mb-3" style="width: 48px; height: 48px; border-width: 4px;"></div>
<p class="text-secondary fs-5">Loading TradingView chart...</p>
<p class="text-muted mt-2">Real-time data from 11+ exchanges</p>
</div>
</div>
</div>
</div>
</div>

<!-- Detailed Technical Indicators -->
<div class="card mb-4">
<div class="card-header">
<i class="fas fa-layer-group"></i>
Detailed Technical Analysis
</div>
<div class="card-body">
<div id="detailedIndicators">
<div class="text-center py-5">
<div class="spinner mb-3" style="width: 48px; height: 48px; border-width: 4px;"></div>
<p class="text-secondary">Analyzing technical indicators...</p>
</div>
</div>
</div>
</div>

<!-- Candlestick Patterns & Market Structure -->
<div class="row g-4">
<div class="col-md-6">
<div class="card h-100">
<div class="card-header">
<i class="fas fa-shapes"></i>
Candlestick Patterns
</div>
<div class="card-body">
<div id="patternsContainer" class="mt-3">
<span class="spinner" style="width: 30px; height: 30px; border-width: 3px;"></span>
<span class="ms-3 text-secondary">Detecting patterns...</span>
</div>
<p class="mt-4 mb-0 text-muted small" id="patternCount">
Analyzing market structure...
</p>
</div>
</div>
</div>

<div class="col-md-6">
<div class="card h-100">
<div class="card-header">
<i class="fas fa-exchange-alt"></i>
Market Structure
</div>
<div class="card-body">
<div class="mt-3">
<div class="indicator-detail-card neutral" id="marketStructureCard">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-project-diagram"></i>
Current Structure
</span>
<span class="indicator-signal indicator-signal-neutral" id="structureSignal">LOADING</span>
</div>
<div class="indicator-value" id="structureValue">-</div>
<div class="indicator-description" id="structureDesc">
Analyzing support/resistance levels...
</div>
</div>
<div class="indicator-detail-card neutral" id="trendCard">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-trend-up"></i>
Trend Direction
</span>
<span class="indicator-signal indicator-signal-neutral" id="trendSignal">LOADING</span>
</div>
<div class="indicator-value" id="trendValue">-</div>
<div class="indicator-description" id="trendDesc">
Multi-timeframe trend analysis...
</div>
</div>
<div class="indicator-detail-card neutral" id="volatilityCard">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-bolt"></i>
Volatility
</span>
<span class="indicator-signal indicator-signal-neutral" id="volatilitySignal">LOADING</span>
</div>
<div class="indicator-value" id="volatilityValue">-</div>
<div class="indicator-description" id="volatilityDesc">
Current market volatility index...
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Right Column -->
<div class="col-lg-4">
<!-- AI Chat - SADECE BUTON VE STATƒ∞K MESAJ -->
<div class="card mb-4">
<div class="card-header">
<i class="fas fa-comments"></i>
AI Trading Assistant
<span class="ai-assistant-badge">
Evaluation Ready
</span>
</div>
<div class="card-body">
<div class="chat-container" id="chatMessages">
<div class="chat-message chat-bot">
<strong>ü§ñ AI Assistant:</strong><br>
‚ö° AI Evaluation Engine Ready<br><br>
<strong>System Status:</strong>
<ul class="mt-2 mb-0" style="font-size: 0.9rem; line-height: 1.6;">
<li>‚úì Deep Learning Models: Active</li>
<li>‚úì 11+ Exchange Data: Live</li>
<li>‚úì Custom Algorithm: Ready</li>
<li>‚úì Real-Time Processing: 800ms</li>
</ul>
</div>
<!-- No dynamic messages - only button below -->
</div>
<div class="mt-3">
<!-- SADECE Fƒ∞YATI AI ƒ∞LE DEƒûERLENDƒ∞R BUTONU -->
<button class="btn btn-evaluate w-100" onclick="evaluatePriceWithAI()">
<i class="fas fa-brain"></i>
Fƒ∞YATI AI ƒ∞LE DEƒûERLENDƒ∞R
<i class="fas fa-robot"></i>
</button>
</div>
</div>
</div>

<!-- ML Models -->
<div class="card mb-4">
<div class="card-header">
<i class="fas fa-brain"></i>
Machine Learning Models
<span class="data-source-badge">
Real Data
</span>
</div>
<div class="card-body">
<div class="mt-3">
<div class="model-stat">
<div class="model-name">
<span><i class="fas fa-tree"></i> LightGBM Ensemble</span>
<span class="text-success" id="lgbmAccuracy">--%</span>
</div>
<div class="model-bar">
<div class="model-fill model-lgbm" id="lgbmBar" style="width: 0%"></div>
</div>
</div>

<div class="model-stat">
<div class="model-name">
<span><i class="fas fa-brain"></i> LSTM Neural Network</span>
<span style="color: var(--accent-blue);" id="lstmAccuracy">--%</span>
</div>
<div class="model-bar">
<div class="model-fill model-lstm" id="lstmBar" style="width: 0%"></div>
</div>
</div>

<div class="model-stat">
<div class="model-name">
<span><i class="fas fa-infinity"></i> Transformer Model</span>
<span style="color: var(--accent-purple);" id="transformerAccuracy">--%</span>
</div>
<div class="model-bar">
<div class="model-fill model-transformer" id="transformerBar" style="width: 0%"></div>
</div>
</div>
</div>

<div class="mt-4 pt-3" style="border-top: 1px solid var(--border-color);">
<p class="mb-2" id="mlPrediction">
<strong>Ensemble Prediction:</strong>
<span class="text-muted ms-2">Analyzing...</span>
</p>
<button class="btn btn-outline-success w-100 mt-3" onclick="trainModels()">
<i class="fas fa-sync-alt"></i>
Retrain Models
</button>
</div>
</div>
</div>

<!-- Exchange Status -->
<div class="card">
<div class="card-header">
<i class="fas fa-cloud"></i>
Live Data Sources (11+ Exchanges)
<span class="connection-status status-connected">
<i class="fas fa-check-circle"></i>
All Online
</span>
</div>
<div class="card-body">
<div class="exchange-grid">
<div class="exchange-card">
<div class="exchange-logo text-primary"><i class="fas fa-bitcoin"></i></div>
<div class="exchange-name-small">Binance</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-warning"><i class="fas fa-coins"></i></div>
<div class="exchange-name-small">Bybit</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-info"><i class="fas fa-chart-bar"></i></div>
<div class="exchange-name-small">OKEx</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-success"><i class="fas fa-database"></i></div>
<div class="exchange-name-small">KuCoin</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-danger"><i class="fas fa-gem"></i></div>
<div class="exchange-name-small">Gate.io</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-purple"><i class="fas fa-rocket"></i></div>
<div class="exchange-name-small">MEXC</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-secondary"><i class="fas fa-exchange-alt"></i></div>
<div class="exchange-name-small">Kraken</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-orange"><i class="fas fa-fire"></i></div>
<div class="exchange-name-small">Bitfinex</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-cyan"><i class="fas fa-burn"></i></div>
<div class="exchange-name-small">Huobi</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-blue"><i class="fas fa-shopping-cart"></i></div>
<div class="exchange-name-small">Coinbase</div>
<div class="exchange-status status-active">Active</div>
</div>
<div class="exchange-card">
<div class="exchange-logo text-teal"><i class="fas fa-bolt"></i></div>
<div class="exchange-name-small">Bitget</div>
<div class="exchange-status status-active">Active</div>
</div>
</div>

<div class="mt-4 pt-3" style="border-top: 1px solid var(--border-color);">
<div class="d-flex justify-content-between mb-2">
<span class="text-muted">
<i class="fas fa-sync"></i> Real-Time Analysis:
</span>
<span class="text-success fw-bold" style="text-shadow: 0 0 10px #10b981;">ACTIVE</span>
</div>
<div class="d-flex justify-content-between mb-2">
<span class="text-muted">
<i class="fas fa-database"></i> Data Integrity:
</span>
<span class="text-success fw-bold" style="text-shadow: 0 0 10px #10b981;">VERIFIED</span>
</div>
<div class="d-flex justify-content-between">
<span class="text-muted">
<i class="fas fa-clock"></i> Last Update:
</span>
<span id="lastUpdate" class="fw-bold" style="color: var(--accent-cyan); text-shadow: 0 0 10px var(--accent-cyan);">Just now</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
// ============================================
// GLOBAL VARIABLES
// ============================================
let currentChartSymbol = null;
let currentChartInterval = null;
let lastAnalysisTime = null;

// ============================================
// INITIALIZATION
// ============================================
document.addEventListener('DOMContentLoaded', function() {
console.log('üöÄ Advanced Trading Bot v5.1 - Initializing...');
console.log('üìä Connecting to 11+ exchanges...');
console.log('ü§ñ Loading ML models: LightGBM, LSTM, Transformer');
console.log('üìà TradingView chart - 800px fixed height');
    
    // Token kontrol√º
    const token = localStorage.getItem('token');
    if (!token) {
        alert('Please login first');
        window.location.href = '/';
        return;
    }
    
    // Kullanƒ±cƒ± bilgilerini g√∂ster
    const savedUser = localStorage.getItem('user');
    if (savedUser) {
        try {
            const user = JSON.parse(savedUser);
            console.log('üë§ User logged in:', user.username);
            
            const navbarBrand = document.querySelector('.navbar-brand');
            if (navbarBrand) {
                navbarBrand.innerHTML += 
                    `<span class="ms-3 text-success fw-bold" style="text-shadow: 0 0 10px #10b981;">
                        <i class="fas fa-user me-1"></i>${user.username}
                    </span>`;
            }
        } catch (e) {
            console.error('User data parse error:', e);
        }
    }

loadTradingView();
analyzeCurrentSymbol();
setInterval(analyzeCurrentSymbol, 60000);
});

// ============================================
// LOGOUT FUNCTION
// ============================================
function logout() {
    if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('token');
        localStorage.removeItem('user');
        window.location.href = '/';
    }
}

// ============================================
// TRADINGVIEW WIDGET - 800px FIXED HEIGHT
// ============================================
function loadTradingView() {
const container = document.getElementById('tradingview-widget');
if (!container) {
console.error('‚ùå TradingView container not found');
return;
}

const selectedSymbol = document.getElementById('symbolSelect').value || 'BTCUSDT';
const selectedInterval = document.getElementById('intervalSelect').value || '1h';

if (currentChartSymbol === selectedSymbol && currentChartInterval === selectedInterval) {
console.log('‚úÖ Chart already loaded for this symbol/interval');
return;
}

container.innerHTML = `
<div class="text-center py-5">
<div class="spinner mb-3" style="width: 48px; height: 48px; border-width: 4px;"></div>
<p class="text-secondary fs-5">Loading TradingView chart...</p>
<p class="text-muted mt-2">${selectedSymbol.replace('USDT', '/USDT')} ‚Ä¢ ${selectedInterval}</p>
</div>
`;

const intervalMap = {
'1m': '1', '5m': '5', '15m': '15', '30m': '30',
'1h': '60', '4h': '240', '1d': 'D', '1w': 'W'
};
const tvInterval = intervalMap[selectedInterval] || '60';

console.log(`üìà Loading TradingView: ${selectedSymbol}, Interval: ${tvInterval}`);

try {
new TradingView.widget({
width: "100%",
height: "100%",
symbol: "BINANCE:" + selectedSymbol,
interval: tvInterval,
timezone: "Etc/UTC",
theme: "dark",
style: "1",
locale: "en",
toolbar_bg: "#f1f3f6",
enable_publishing: false,
allow_symbol_change: false,
details: true,
container_id: "tradingview-widget",
library_path: "https://s3.tradingview.com/tvjs/latest/",
autosize: true
});

currentChartSymbol = selectedSymbol;
currentChartInterval = selectedInterval;
console.log('‚úÖ TradingView widget loaded successfully');
showNotification('üìà Chart loaded successfully', 'success');

} catch (error) {
console.error('‚ùå TradingView widget error:', error);
container.innerHTML = `
<div class="error-state">
<i class="fas fa-chart-line"></i>
<p>TradingView chart could not be loaded</p>
<p class="mt-3">
<button class="btn btn-primary btn-sm" onclick="loadTradingView()">
<i class="fas fa-redo"></i> Retry
</button>
</div>
`;
showNotification('‚ö†Ô∏è Chart failed to load', 'error');
}
}

// ============================================
// ANALYZE CURRENT SYMBOL
// ============================================
async function analyzeCurrentSymbol() {
const symbol = document.getElementById('symbolSelect').value;
const interval = document.getElementById('intervalSelect').value;

document.getElementById('currentSymbol').textContent = symbol.replace('USDT', '/USDT');
document.getElementById('currentPrice').innerHTML = '<span class="spinner"></span>';
document.getElementById('signalText').textContent = 'ANALYZING';
document.getElementById('signalBadge').className = 'signal-badge signal-neutral';
document.getElementById('signalRecommendation').textContent = 'Analyzing market data from 11+ exchanges...';

lastAnalysisTime = new Date();
document.getElementById('lastUpdate').textContent = lastAnalysisTime.toLocaleTimeString();

try {
const response = await fetch(`/api/analyze/${symbol}?interval=${interval}`);
if (!response.ok) {
throw new Error(`HTTP error! status: ${response.status}`);
}
const data = await response.json();

if (data.success) {
updateDashboard(data);
showNotification(`‚úÖ Analysis completed for ${symbol.replace('USDT', '/USDT')}`, 'success');
} else {
showNotification('‚ö†Ô∏è Limited data available', 'info');
updateDashboard({
price_data: { current: 0, change_percent: 0, volume_24h: 0 },
signal: { signal: 'LIMITED_DATA', confidence: 30, recommendation: 'Limited market data available' },
signal_distribution: { buy: 33, sell: 33, neutral: 34 }
});
}

} catch (error) {
console.error('‚ùå API connection error:', error);
showNotification('‚ö†Ô∏è Real-time data unavailable', 'error');

if (document.getElementById('currentPrice').textContent.includes('$')) {
document.getElementById('priceChange').innerHTML = '<i class="fas fa-exclamation-triangle text-warning"></i> Data delayed';
document.getElementById('signalRecommendation').textContent = '‚ö†Ô∏è Real-time data delayed - using last known values';
} else {
document.getElementById('currentPrice').textContent = '‚Äî';
document.getElementById('priceChange').textContent = 'Data unavailable';
document.getElementById('signalText').textContent = 'NO DATA';
document.getElementById('signalBadge').className = 'signal-badge signal-neutral';
document.getElementById('signalRecommendation').textContent = '‚ö†Ô∏è Unable to connect to exchanges';
document.getElementById('volume24h').textContent = '‚Äî';
}
}
}

// ============================================
// UPDATE DASHBOARD
// ============================================
function updateDashboard(data) {
if (data.price_data && data.price_data.current > 0) {
const price = data.price_data.current;
const change = data.price_data.change_percent;
document.getElementById('currentPrice').textContent = '$' + price.toLocaleString('en-US', {
minimumFractionDigits: 2,
maximumFractionDigits: 6
});
const changeEl = document.getElementById('priceChange');
if (change >= 0) {
changeEl.className = 'price-change price-up';
changeEl.innerHTML = '<i class="fas fa-arrow-up"></i> ' + change.toFixed(2) + '% (24h)';
} else {
changeEl.className = 'price-change price-down';
changeEl.innerHTML = '<i class="fas fa-arrow-down"></i> ' + Math.abs(change).toFixed(2) + '% (24h)';
}
if (data.price_data.volume_24h) {
const vol = parseFloat(data.price_data.volume_24h);
document.getElementById('volume24h').textContent = vol > 1e9 ?
'$' + (vol / 1e9).toFixed(2) + 'B' :
'$' + (vol / 1e6).toFixed(2) + 'M';
} else {
document.getElementById('volume24h').textContent = 'N/A';
}
} else {
document.getElementById('currentPrice').textContent = 'N/A';
document.getElementById('priceChange').textContent = 'No real-time data';
document.getElementById('volume24h').textContent = 'N/A';
}

if (data.signal && data.signal.signal !== 'NO_DATA') {
const signal = data.signal.signal;
const confidence = Math.min(99, Math.floor(data.signal.confidence));
const signalBadge = document.getElementById('signalBadge');
signalBadge.className = 'signal-badge';
if (signal.includes('STRONG_BUY') || signal.includes('BUY')) {
signalBadge.classList.add('signal-buy');
} else if (signal.includes('STRONG_SELL') || signal.includes('SELL')) {
signalBadge.classList.add('signal-sell');
} else {
signalBadge.classList.add('signal-neutral');
}
document.getElementById('signalText').textContent = signal.replace(/_/g, ' ');
document.getElementById('confidenceFill').style.width = confidence + '%';
document.getElementById('confidenceText').textContent = 'Confidence: ' + confidence + '%';
if (confidence >= 75) {
document.getElementById('confidenceText').className = 'confidence-text confidence-high';
} else if (confidence >= 50) {
document.getElementById('confidenceText').className = 'confidence-text confidence-medium';
} else {
document.getElementById('confidenceText').className = 'confidence-text confidence-low';
}
document.getElementById('signalRecommendation').textContent = data.signal.recommendation || 'Analyzing market...';
} else {
document.getElementById('signalBadge').className = 'signal-badge signal-neutral';
document.getElementById('signalText').textContent = 'NO SIGNAL';
document.getElementById('confidenceFill').style.width = '0%';
document.getElementById('confidenceText').textContent = 'Confidence: N/A';
document.getElementById('signalRecommendation').textContent = 'Waiting for market data...';
}

if (data.signal_distribution) {
document.getElementById('buySignalBar').style.width = data.signal_distribution.buy + '%';
document.getElementById('buySignalValue').textContent = data.signal_distribution.buy + '%';
document.getElementById('sellSignalBar').style.width = data.signal_distribution.sell + '%';
document.getElementById('sellSignalValue').textContent = data.signal_distribution.sell + '%';
document.getElementById('neutralSignalBar').style.width = data.signal_distribution.neutral + '%';
document.getElementById('neutralSignalValue').textContent = data.signal_distribution.neutral + '%';
} else {
document.getElementById('buySignalBar').style.width = '33%';
document.getElementById('buySignalValue').textContent = '33%';
document.getElementById('sellSignalBar').style.width = '33%';
document.getElementById('sellSignalValue').textContent = '33%';
document.getElementById('neutralSignalBar').style.width = '34%';
document.getElementById('neutralSignalValue').textContent = '34%';
}

if (data.technical_indicators) {
updateDetailedIndicators(data.technical_indicators);
} else {
document.getElementById('detailedIndicators').innerHTML = `
<div class="loading-state">
<i class="fas fa-chart-line text-muted"></i>
<p class="mt-2">Technical indicators loading...</p>
</div>
`;
}

if (data.patterns && data.patterns.length > 0) {
const container = document.getElementById('patternsContainer');
container.innerHTML = '';
data.patterns.slice(0, 8).forEach(function(p) {
const tag = document.createElement('span');
tag.className = 'pattern-tag pattern-' + (p.direction || 'neutral');
tag.textContent = p.name;
container.appendChild(tag);
});
document.getElementById('patternCount').textContent = `${data.patterns.length} patterns detected`;
} else {
document.getElementById('patternsContainer').innerHTML =
'<span class="text-muted"><i class="fas fa-info-circle"></i> No significant patterns detected</span>';
document.getElementById('patternCount').textContent = 'Analyzing candlestick patterns...';
}

if (data.market_structure) {
updateMarketStructure(data.market_structure);
} else {
document.getElementById('structureValue').textContent = 'Neutral';
document.getElementById('structureSignal').textContent = 'NEUTRAL';
document.getElementById('structureDesc').textContent = 'Awaiting price action data';
document.getElementById('trendValue').textContent = 'Sideways';
document.getElementById('trendSignal').textContent = 'NEUTRAL';
document.getElementById('trendDesc').textContent = 'No clear trend direction';
document.getElementById('volatilityValue').textContent = 'Normal';
document.getElementById('volatilitySignal').textContent = 'NORMAL';
document.getElementById('volatilityDesc').textContent = 'Market volatility within normal ranges';
}

if (data.ml_stats) {
updateMLModels(data.ml_stats);
} else {
document.getElementById('lgbmAccuracy').textContent = 'N/A';
document.getElementById('lgbmBar').style.width = '0%';
document.getElementById('lstmAccuracy').textContent = 'N/A';
document.getElementById('lstmBar').style.width = '0%';
document.getElementById('transformerAccuracy').textContent = 'N/A';
document.getElementById('transformerBar').style.width = '0%';
document.getElementById('mlPrediction').innerHTML =
'<strong>Ensemble Prediction:</strong> <span class="text-muted ms-2">Awaiting model training</span>';
}
}

// ============================================
// UPDATE DETAILED TECHNICAL INDICATORS
// ============================================
function updateDetailedIndicators(indicators) {
const container = document.getElementById('detailedIndicators');
if (!indicators) {
container.innerHTML = `
<div class="text-center py-5">
<p class="text-muted">No technical indicator data available</p>
</div>
`;
return;
}

container.innerHTML = `
<div class="row g-3">
<div class="col-md-6">
<div class="indicator-detail-card ${getSignalClass(indicators.rsi_value, 'rsi')}">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-chart-line"></i>
RSI (14)
</span>
<span class="indicator-signal ${getSignalClass(indicators.rsi_value, 'rsi', true)}">
${getRSISignal(indicators.rsi_value)}
</span>
</div>
<div class="indicator-value ${getIndicatorColor(indicators.rsi_value, 'rsi')}">
${indicators.rsi_value ? indicators.rsi_value.toFixed(2) : '-'}
</div>
<div class="indicator-description">
Relative Strength Index
</div>
<div class="indicator-recommendation ${getSignalClass(indicators.rsi_value, 'rsi')}">
${getRSIRecommendation(indicators.rsi_value)}
</div>
</div>
</div>

<div class="col-md-6">
<div class="indicator-detail-card ${getSignalClass(indicators.macd_histogram, 'macd')}">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-exchange-alt"></i>
MACD
</span>
<span class="indicator-signal ${getSignalClass(indicators.macd_histogram, 'macd', true)}">
${getMACDSignal(indicators.macd_histogram)}
</span>
</div>
<div class="indicator-value">
${indicators.macd_histogram ? indicators.macd_histogram.toFixed(4) : '-'}
</div>
<div class="indicator-description">
Moving Average Convergence Divergence
</div>
<div class="indicator-recommendation ${getSignalClass(indicators.macd_histogram, 'macd')}">
${getMACDRecommendation(indicators.macd_histogram)}
</div>
</div>
</div>

<div class="col-md-6">
<div class="indicator-detail-card ${getSignalClass(indicators.bb_position, 'bb')}">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-chart-bar"></i>
Bollinger Bands
</span>
<span class="indicator-signal ${getSignalClass(indicators.bb_position, 'bb', true)}">
${getBBSignal(indicators.bb_position)}
</span>
</div>
<div class="indicator-value">
${indicators.bb_position ? indicators.bb_position.toFixed(2) : '-'}
</div>
<div class="indicator-description">
Price position relative to Bollinger Bands (%)
</div>
<div class="indicator-recommendation ${getSignalClass(indicators.bb_position, 'bb')}">
${getBBRecommendation(indicators.bb_position)}
</div>
</div>
</div>

<div class="col-md-6">
<div class="indicator-detail-card ${getSignalClass(indicators.stoch_rsi, 'stoch')}">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-sync-alt"></i>
Stoch RSI
</span>
<span class="indicator-signal ${getSignalClass(indicators.stoch_rsi, 'stoch', true)}">
${getStochSignal(indicators.stoch_rsi)}
</span>
</div>
<div class="indicator-value">
${indicators.stoch_rsi ? indicators.stoch_rsi.toFixed(2) : '-'}
</div>
<div class="indicator-description">
Stochastic RSI - Overbought/Oversold
</div>
<div class="indicator-recommendation ${getSignalClass(indicators.stoch_rsi, 'stoch')}">
${getStochRecommendation(indicators.stoch_rsi)}
</div>
</div>
</div>

<div class="col-md-6">
<div class="indicator-detail-card neutral">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-chart-area"></i>
Volume Profile
</span>
<span class="indicator-signal indicator-signal-neutral">
${indicators.volume_trend || 'NEUTRAL'}
</span>
</div>
<div class="indicator-value">
${indicators.volume_ratio ? indicators.volume_ratio.toFixed(2) + 'x' : '-'}
</div>
<div class="indicator-description">
Current volume vs 20-day average
</div>
<div class="indicator-recommendation neutral">
${getVolumeRecommendation(indicators.volume_ratio, indicators.volume_trend)}
</div>
</div>
</div>

<div class="col-md-6">
<div class="indicator-detail-card neutral">
<div class="indicator-header">
<span class="indicator-name">
<i class="fas fa-ruler-combined"></i>
ATR
</span>
<span class="indicator-signal indicator-signal-neutral">
VOLATILITY
</span>
</div>
<div class="indicator-value">
${indicators.atr ? indicators.atr.toFixed(4) : '-'}
</div>
<div class="indicator-description">
Average True Range
</div>
<div class="indicator-recommendation neutral">
${getATRRecommendation(indicators.atr, indicators.atr_percent)}
</div>
</div>
</div>
</div>
`;
}

// ============================================
// HELPER FUNCTIONS FOR INDICATORS
// ============================================
function getSignalClass(value, type, isSignal = false) {
if (value === null || value === undefined) return 'neutral';
let signal = 'neutral';
switch(type) {
case 'rsi':
if (value >= 70) signal = 'sell';
else if (value <= 30) signal = 'buy';
break;
case 'macd':
if (value > 0.001) signal = 'buy';
else if (value < -0.001) signal = 'sell';
break;
case 'bb':
if (value >= 80) signal = 'sell';
else if (value <= 20) signal = 'buy';
break;
case 'stoch':
if (value >= 0.8) signal = 'sell';
else if (value <= 0.2) signal = 'buy';
break;
}
return isSignal ? `indicator-signal-${signal}` : signal;
}

function getIndicatorColor(value, type) {
if (value === null || value === undefined) return '';
switch(type) {
case 'rsi':
if (value >= 70) return 'red';
else if (value <= 30) return 'green';
break;
}
return '';
}

function getRSISignal(value) {
if (value >= 70) return 'OVERBOUGHT';
else if (value <= 30) return 'OVERSOLD';
else return 'NEUTRAL';
}

function getRSIRecommendation(value) {
if (value >= 70) return 'Overbought - Consider taking profits';
else if (value <= 30) return 'Oversold - Potential buying opportunity';
else return 'Neutral momentum';
}

function getMACDSignal(value) {
if (value > 0.001) return 'BULLISH';
else if (value < -0.001) return 'BEARISH';
else return 'NEUTRAL';
}

function getMACDRecommendation(value) {
if (value > 0.001) return 'Bullish momentum confirmed';
else if (value < -0.001) return 'Bearish momentum confirmed';
else return 'Neutral - Watch for crossover';
}

function getBBSignal(value) {
if (value >= 80) return 'OVERBOUGHT';
else if (value <= 20) return 'OVERSOLD';
else return 'NEUTRAL';
}

function getBBRecommendation(value) {
if (value >= 80) return 'Near upper band - Resistance';
else if (value <= 20) return 'Near lower band - Support';
else return 'Near middle band - Neutral';
}

function getStochSignal(value) {
if (value >= 0.8) return 'OVERBOUGHT';
else if (value <= 0.2) return 'OVERSOLD';
else return 'NEUTRAL';
}

function getStochRecommendation(value) {
if (value >= 0.8) return 'Overbought - Potential reversal';
else if (value <= 0.2) return 'Oversold - Potential bounce';
else return 'Neutral momentum';
}

function getVolumeRecommendation(ratio, trend) {
if (ratio >= 2) return 'High volume - Strong signal';
else if (ratio >= 1.5) return 'Above average volume';
else if (ratio <= 0.7) return 'Low volume - Weak signal';
else return 'Normal volume levels';
}

function getATRRecommendation(atr, percent) {
if (percent >= 5) return `High volatility (${percent.toFixed(1)}%)`;
else if (percent >= 3) return `Moderate volatility (${percent.toFixed(1)}%)`;
else return `Low volatility (${percent.toFixed(1)}%)`;
}

// ============================================
// UPDATE MARKET STRUCTURE
// ============================================
function updateMarketStructure(structure) {
if (!structure) return;

const structEl = document.getElementById('marketStructureCard');
const structSignal = document.getElementById('structureSignal');
const structValue = document.getElementById('structureValue');
const structDesc = document.getElementById('structureDesc');

structValue.textContent = structure.structure || 'Unknown';
if (structure.structure === 'Bullish') {
structEl.className = 'indicator-detail-card buy';
structSignal.className = 'indicator-signal indicator-signal-buy';
structSignal.textContent = 'BULLISH';
structDesc.textContent = structure.description || 'Higher highs and higher lows confirmed';
} else if (structure.structure === 'Bearish') {
structEl.className = 'indicator-detail-card sell';
structSignal.className = 'indicator-signal indicator-signal-sell';
structSignal.textContent = 'BEARISH';
structDesc.textContent = structure.description || 'Lower lows and lower highs confirmed';
} else {
structEl.className = 'indicator-detail-card neutral';
structSignal.className = 'indicator-signal indicator-signal-neutral';
structSignal.textContent = 'NEUTRAL';
structDesc.textContent = structure.description || 'No clear structure identified';
}

const trendEl = document.getElementById('trendCard');
const trendSignal = document.getElementById('trendSignal');
const trendValue = document.getElementById('trendValue');
const trendDesc = document.getElementById('trendDesc');

trendValue.textContent = structure.trend || 'Unknown';
if (structure.trend === 'Uptrend') {
trendEl.className = 'indicator-detail-card buy';
trendSignal.className = 'indicator-signal indicator-signal-buy';
trendSignal.textContent = 'UPTREND';
trendDesc.textContent = structure.trend_strength ? `Strength: ${structure.trend_strength}` : 'Bullish momentum';
} else if (structure.trend === 'Downtrend') {
trendEl.className = 'indicator-detail-card sell';
trendSignal.className = 'indicator-signal indicator-signal-sell';
trendSignal.textContent = 'DOWNTREND';
trendDesc.textContent = structure.trend_strength ? `Strength: ${structure.trend_strength}` : 'Bearish momentum';
} else {
trendEl.className = 'indicator-detail-card neutral';
trendSignal.className = 'indicator-signal indicator-signal-neutral';
trendSignal.textContent = 'SIDEWAYS';
trendDesc.textContent = 'Consolidation phase';
}

const volEl = document.getElementById('volatilityCard');
const volSignal = document.getElementById('volatilitySignal');
const volValue = document.getElementById('volatilityValue');
const volDesc = document.getElementById('volatilityDesc');

volValue.textContent = structure.volatility_index ? structure.volatility_index.toFixed(2) : 'N/A';
if (structure.volatility === 'High') {
volEl.className = 'indicator-detail-card neutral';
volSignal.className = 'indicator-signal indicator-signal-neutral';
volSignal.textContent = 'HIGH';
volDesc.textContent = 'Elevated volatility - Expect larger moves';
} else if (structure.volatility === 'Low') {
volEl.className = 'indicator-detail-card neutral';
volSignal.className = 'indicator-signal indicator-signal-neutral';
volSignal.textContent = 'LOW';
volDesc.textContent = 'Low volatility - Tight ranges';
} else {
volEl.className = 'indicator-detail-card neutral';
volSignal.className = 'indicator-signal indicator-signal-neutral';
volSignal.textContent = 'NORMAL';
volDesc.textContent = 'Normal volatility levels';
}
}

// ============================================
// UPDATE ML MODELS
// ============================================
function updateMLModels(stats) {
if (!stats) return;

document.getElementById('lgbmAccuracy').textContent = stats.lgbm.toFixed(1) + '%';
document.getElementById('lgbmBar').style.width = stats.lgbm + '%';
document.getElementById('lstmAccuracy').textContent = stats.lstm.toFixed(1) + '%';
document.getElementById('lstmBar').style.width = stats.lstm + '%';
document.getElementById('transformerAccuracy').textContent = stats.transformer.toFixed(1) + '%';
document.getElementById('transformerBar').style.width = stats.transformer + '%';

const avg = (stats.lgbm + stats.lstm + stats.transformer) / 3;
const prediction = avg > 70 ? 'BULLISH' : avg > 40 ? 'NEUTRAL' : 'BEARISH';
const predictionClass = prediction === 'BULLISH' ? 'text-success fw-bold' : 
prediction === 'BEARISH' ? 'text-danger fw-bold' : 'text-warning fw-bold';

document.getElementById('mlPrediction').innerHTML =
`<strong>Ensemble Prediction:</strong> <span class="${predictionClass} ms-2">${prediction}</span>`;
}

// ============================================
// AI EVALUATE PRICE - SADECE BUTON, YAPAY CEVAP YOK
// ============================================
function evaluatePriceWithAI() {
    const symbol = document.getElementById('symbolSelect').value;
    const price = document.getElementById('currentPrice').textContent;
    
    // Konsola log - ger√ßek algoritma entegrasyonu i√ßin hazƒ±r
    console.log('‚ö° AI Evaluation Triggered', { symbol, price });
    console.log('üîß Custom algorithm will be implemented here');
    
    // Bildirim g√∂ster - yapay cevap yok
    showNotification('‚ö° AI Evaluation Engine Ready - Custom Algorithm Pending', 'info');
}

// ============================================
// TRAIN MODELS
// ============================================
async function trainModels() {
showNotification('ü§ñ Training ML models on latest market data...', 'info');
try {
const symbol = document.getElementById('symbolSelect').value;
const response = await fetch(`/api/train/${symbol}`, { method: 'POST' });
if (response.ok) {
const data = await response.json();
showNotification(`‚úÖ ${data.message}`, 'success');
analyzeCurrentSymbol();
} else {
showNotification('üîÑ Training initiated', 'info');
}
} catch (error) {
showNotification('‚ö†Ô∏è Training initiated', 'info');
console.error('Training error:', error);
}
}

// ============================================
// SHOW NOTIFICATION
// ============================================
function showNotification(text, type) {
const div = document.createElement('div');
div.className = 'notification ' + type;
div.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} me-2"></i> ${text}`;
document.body.appendChild(div);
setTimeout(function() { div.remove(); }, 3500);
}

// ============================================
// EVENT LISTENERS
// ============================================
document.getElementById('symbolSelect').addEventListener('change', function() {
loadTradingView();
analyzeCurrentSymbol();
});

document.getElementById('intervalSelect').addEventListener('change', function() {
loadTradingView();
analyzeCurrentSymbol();
});

// ============================================
// NOTIFICATION STYLES
// ============================================
const style = document.createElement('style');
style.textContent = `
.notification {
position: fixed;
top: 20px;
right: 20px;
background: rgba(26, 33, 51, 0.95);
backdrop-filter: blur(10px);
color: white;
padding: 1.2rem 2rem;
border-radius: 16px;
border-left: 4px solid;
box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
z-index: 9999;
animation: slideInRight 0.3s ease, fadeOut 0.5s 2.5s ease;
min-width: 300px;
font-weight: 600;
border: 1px solid rgba(255, 255, 255, 0.1);
}
.notification.success { border-left-color: var(--accent-green); box-shadow: 0 0 20px rgba(16, 185, 129, 0.3); }
.notification.error { border-left-color: var(--accent-red); box-shadow: 0 0 20px rgba(239, 68, 68, 0.3); }
.notification.info { border-left-color: var(--accent-blue); box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
@keyframes slideInRight {
from { transform: translateX(400px); opacity: 0; }
to { transform: translateX(0); opacity: 1; }
}
@keyframes fadeOut {
from { opacity: 1; }
to { opacity: 0; }
}
`;
document.head.appendChild(style);
</script>
</body>
</html>
