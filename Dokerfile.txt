# Use official lightweight Node.js 20 image
FROM node:20-alpine

# Set working directory
WORKDIR /app

# Copy dependency manifests
COPY package*.json ./

# Install dependencies (omit dev for production)
RUN npm ci --omit=dev

# Copy source code
COPY . .

# Build the app (no-op if unnecessary, safe for minimal projects)
RUN npm run build || echo "No build step required"

# Expose port
EXPOSE 3000

# Start command
CMD ["npm", "run", "start:prod"]